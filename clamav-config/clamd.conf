# clamav-config/clamd.conf
# ClamAV daemon configuration

# Remove or comment out the Example line to enable this config
# Example

##
## Main options
##

# Uncomment this option to enable logging.
LogFile /var/log/clamav/clamd.log

LogFileUnlock no

# Maximum size of the log file.
LogFileMaxSize 50M

# Log time with each message.
LogTime yes

#log clean files.
LogClean no

# Use system logger (can work together with LogFile).
LogSyslog yes

# Specify the type of syslog messages - refer to 'man syslog'
# for facility names.
LogFacility LOG_LOCAL6

# Enable verbose logging.
LogVerbose yes

# Enable log rotation. It requires LogFileMaxSize option set prior to this option.
LogRotate yes

# This option allows to save a process identifier of the listening daemon (main thread).
PidFile /var/run/clamav/clamd.pid

# Optional path to the global temporary directory.
TemporaryDirectory /tmp

# Path to the database directory.
DatabaseDirectory /var/lib/clamav

# The daemon works in a local OR a network mode. Due to security reasons we
# recommend the local mode.

# Path to a local socket file the daemon will listen on.
LocalSocket /var/run/clamav/clamd.ctl

# Sets the group ownership on the unix socket.
LocalSocketGroup clamav

# Sets the permissions on the unix socket to the specified mode.
LocalSocketMode 666

# Remove stale socket after unclean shutdown.
FixStaleSocket yes

# TCP port address.
TCPSocket 3310

# TCP address.
TCPAddr 0.0.0.0

# Maximum length the queue of pending connections may grow to.
MaxConnectionQueueLength 30

# Clamd uses FTP-like protocol to receive data from remote clients.
# If you are using clamav-milter to balance load between remote clamd daemons
# on firewall servers you may need to tune the options below.

# Close the connection when the data size limit is exceeded.
# The value should match your MTA's limit for a maximum attachment size.
StreamMaxLength 100M

# Maximum number of threads running at the same time.
MaxThreads 4

# Waiting for data from a client socket will timeout after this time (seconds).
ReadTimeout 300

# This option specifies the time (in seconds) after which clamd should timeout if a client doesn't provide any initial command after connecting.
CommandReadTimeout 30

# This option specifies how long to wait (in milliseconds) if the send buffer is full.
SendBufTimeout 500

# Maximum number of queued items (including those being processed by MaxThreads threads)
# It is recommended to have this value at least twice MaxThreads if possible.
MaxQueue 200

# Waiting for a new job will timeout after this time (seconds).
IdleTimeout 60

# Don't scan files and directories matching regex
# This directive can be used multiple times
ExcludePath ^/proc/
ExcludePath ^/sys/
ExcludePath ^/dev/
ExcludePath ^/tmp/clamd-temp/

# Maximum amount of data to be scanned for each input file.
MaxScanSize 150M

# Files larger than this will be ignored, and scanned as empty files.
MaxFileSize 100M

# Nested archives are scanned recursively, e.g. if a Zip archive contains a RAR
# file, all files within it will also be scanned. This options specifies how
# deeply the process should be continued.
MaxRecursion 16

# Number of files to be scanned within an archive, a document or any other
# container file.
MaxFiles 15000

# Maximum size of HTML file to normalize. HTML files larger than this value
# will not be normalized or scanned.
MaxHTMLNormalize 10M

# Maximum size of normalized HTML file to scan.  HTML files larger than this
# value after normalization will not be scanned.
MaxHTMLNoTags 2M

# Maximum size of script file to normalize. Script content larger than this
# value will not be normalized or scanned.
MaxScriptNormalize 5M

# Maximum size of a ZIP file to reanalyze type recognition. ZIP files larger
# than this value will skip the step to potentially reanalyze as PE.
MaxZipTypeRcg 1M

# This option sets the maximum number of partitions of a raw disk image to be scanned.
MaxPartitions 128

# This option sets the maximum number of icons within a PE to be scanned.
MaxIconsPE 200

# This option sets the maximum recursive calls for HWP3 parsing.
MaxRecHWP3 16

# This option sets the maximum calls to the PCRE match function during
# an instance of regex matching.
PCREMatchLimit 10000

# This option sets the maximum recursive calls to the PCRE match function
# during an instance of regex matching.
PCRERecMatchLimit 10000


# With this option enabled ClamAV will load bytecode from the database if it is digitally signed by Talos.
Bytecode yes

# Set bytecode security level.
# Possible values:
#       None - no security at all, meant for debugging. DO NOT USE THIS ON PRODUCTION SYSTEMS
#         This value is only available if clamav was built with --enable-debug
#       TrustSigned - trust bytecode loaded from signed .cvd files,
#                insert runtime safety checks for bytecode loaded from other sources
#       Paranoid - don't trust any bytecode, insert runtime checks for all
# Recommended: TrustSigned, because bytecode in .cvd files already has these checks
BytecodeSecurity TrustSigned

# Set bytecode timeout in milliseconds.
BytecodeTimeout 10000

# Allow loading bytecode from outside digitally signed .cvd files.
BytecodeUnsigned no

# Detect Possibly Unwanted Applications.
DetectPUA yes

# Exclude a specific PUA category. This directive can be used multiple times.
# See https://github.com/vrtadmin/clamav-faq/blob/master/faq/faq-pua.md for 
# a list of PUA categories
#ExcludePUA NetTool
#ExcludePUA PWTool

# Only include a specific PUA category. This directive can be used multiple times.
IncludePUA Spy
IncludePUA Scanner
IncludePUA RAT

# This option causes memory or nested map scans to dump the content to disk.
# If you turn on this option, more data is written to disk and is available
# when the LeaveTemporaryFiles option is enabled.
ForceToDisk no

# This option allows you to disable the caching feature of the engine. By
# default, the engine will store an MD5 in a cache of any files that are
# not flagged as virus or that hit limits checks. Disabling the cache will
# have a negative performance impact on large scans.
DisableCache no

# In some cases (eg. complex malware, exploits in graphic files, and others),
# ClamAV uses special algorithms to provide accurate detection. This option
# controls the algorithmic detection.
AlgorithmicDetection yes

# This option enables scanning of various archive formats.
ScanArchive yes

# Mark encrypted archives as viruses (Encrypted.Zip, Encrypted.RAR).
ArchiveBlockEncrypted no

# This option enables scanning of OLE2 files, such as Microsoft Office documents and .msi files.
ScanOLE2 yes

# This option enables scanning of PDF files.
ScanPDF yes

# This option enables scanning of SWF files.
ScanSWF yes

# This option enables scanning of HTML files.
ScanHTML yes

# This option enables scanning of XML files.
ScanXMLDOCS yes

# This option enables scanning of HWP3 files.
ScanHWP3 yes

# This option enables scanning of mail files.
ScanMail yes

# Scan RFC1341 messages split over many emails.
ScanPartialMessages yes

# This option enables support for RAR and other archives.
ScanArchive yes

# This option enables the HTML normalizer, which is most effective against HTML exploits.
ScanHTML yes

# The options below are mainly for debugging and will not be documented here.
# Please look up the documentation for more information

##
## Executables
##

# PE stands for Portable Executable - it's an executable file format used in
# all 32 and 64-bit versions of Windows operating systems. This option allows
# ClamAV to perform a deeper analysis of executable files and it's also
# required for decompression of popular executable packers such as UPX, FSG,
# and Petite. If you turn off this option, the original files will still be
# scanned, but without additional processing.
ScanPE yes

# Executable and Linking Format is a standard file format for executables,
# object code, shared libraries and core dumps. This option allows you to
# control the scanning of ELF files.
ScanELF yes

# This option controls the maximum filesize for which ClamAV will perform
# subsignature matching. Signatures for PE and ELF files can be much more
# specific than other file formats, allowing for fewer false positives.
MaxEmbeddedPE 40M

# This option controls the maximum size for HTML normalize.
MaxHTMLNormalize 10M

##
## Archive limits
##

# Files in archives larger than this limit won't be scanned.
MaxScanSize 150M

# Archives larger than this limit won't be scanned.
MaxFileSize 100M

# Maximum recursion level for archives.
MaxRecursion 10

# Maximum number of files to scan for each container file.
MaxFiles 15000

##
## Mail scanning options
##

# Enable internal e-mail scanner.
ScanMail yes

# Scan RFC1341 messages split over many emails.
ScanPartialMessages yes

# With this option enabled ClamAV will try to detect phishing attempts by using
# signatures.
PhishingSignatures yes

# Scan URLs found in mails for phishing attempts using heuristics.
PhishingScanURLs yes

# Always block SSL mismatches in URLs (might lead to false positives!).
PhishingAlwaysBlockSSLMismatch no

# Always block cloaked URLs (might lead to false positives!).
PhishingAlwaysBlockCloak no

# Allow heuristic match to take precedence.
# When enabled, if a heuristic scan (such as phishingScan) finds a possible virus,
# further scanning of the file will be interrupted immediately. Recommended, saves CPU scan-time.
# When disabled, virus scanners will scan the entire file, regardless of whether virus is found.
# Disabled recommended for thorough (slow) scanning.
HeuristicScanPrecedence yes

# Allow heuristic alerts
# With this option enabled OLE2 files with VBA macros, which were not
# detected by signatures will be marked as "Heuristics.OLE2.ContainsMacros".
StructuredDataDetection yes

# With this option enabled the DLP module will search for valid
# SSNs formatted as xxx-xx-xxxx
StructuredSSNFormatNormal yes

# With this option enabled the DLP module will search for valid
# SSNs formatted as xxxxxxxxx
StructuredSSNFormatStripped yes

##
## HTML
##

# Perform HTML/CSS/Script normalization and create temporary files in
# the temporary directory.
ScanHTML yes

##
## Archives
##

# ClamAV can scan within archives and compressed files.
ScanArchive yes

# Mark encrypted archives as viruses (Encrypted.Zip, Encrypted.RAR).
ArchiveBlockEncrypted no

##
## Limits for decompression engines
##

# ZIP and other archives are recursively extracted and scanned.
# This options specifies how deeply the process should be continued.
MaxRecursion 10

# Number of files to be scanned within an archive, a document or any
# other kind of container.
MaxFiles 15000

##
## On-access scanning settings
##

# Don't scan files larger than OnAccessMaxFileSize
OnAccessMaxFileSize 20M

# Set the  include paths (all files inside them will be scanned). You can have
# multiple OnAccessIncludePath directives but each directory must be added
# in a separate line.
# OnAccessIncludePath /home
# OnAccessIncludePath /students

# Set the exclude paths. All subdirectories are also excluded.
# OnAccessExcludePath /home/bofh

# With this option you can whitelist specific UIDs. Processes with these UIDs
# will be able to access all files.
# This option can be used multiple times (one per line).
# OnAccessExcludeUID 0